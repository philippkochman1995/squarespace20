<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Get 20% off your Squarespace site</title>
  <meta name="description" content="Get 20% off your annual Squarespace subscription. Enter your email and (optional) theme link. We'll create a trial and you'll get the invite from Squarespace." />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :focus-visible { outline: 2px solid currentColor; outline-offset: 2px; }
    html, body { height: 100%; }
  </style>
</head>
<body class="bg-white text-gray-900 antialiased">
  <main class="min-h-full flex items-start">
    <div class="mx-auto w-full max-w-md px-4 pt-14 pb-8">
      <!-- Hero -->
<header class="text-left">
  <h1 class="text-4xl sm:text-4xl font-semibold tracking-tight">
    Get 20% off your<br/>Squarespace site
  </h1>
  <p class="mt-5 text-sm text-gray-600 leading-relaxed max-w-sm">
    To get your <strong>20% discount</strong> on your annual <strong>Squarespace</strong>
    subscription enter your e‑mail address and a link to the Squarespace theme you want to use.
  </p>
  <p class="mt-4 text-xs text-gray-500 leading-relaxed max-w-sm">
    <span class="font-medium">How it works:</span> a trial site will be created and you will
    get an invite email from Squarespace. After you accept the invite you can delete our account.
    Choose annual billing to get 20% off on your first payment.
  </p>
</header>


      <!-- Form card (very light) -->
      <section class="mt-8">
        <form id="request-form" class="space-y-5" novalidate>
          <div>
            <label for="email" class="block text-sm font-medium">Your E‑Mail:</label>
            <input
              id="email" name="email" type="email" autocomplete="email" required
              placeholder="you@example.com"
              class="mt-2 w-full rounded-full border border-gray-300 px-4 py-2.5 focus:border-black"
            />
          </div>

          <div>
            <label for="templateUrl" class="block text-sm font-medium">Paste Link To Squarespace Theme:</label>
            <input
              id="templateUrl" name="templateUrl" type="url" inputmode="url"
              placeholder="https://www.squarespace.com/templates/your-theme"
              class="mt-2 w-full rounded-full border border-gray-300 px-4 py-2.5 focus:border-black"
            />
          </div>

          <!-- Honeypot -->
          <div class="hidden" aria-hidden="true">
            <label>Leave this field empty</label>
            <input id="company" name="company" type="text" tabindex="-1" autocomplete="off" />
          </div>

          <button
            type="submit"
            class="w-full rounded-full bg-black text-white py-2.5 text-sm font-medium hover:bg-gray-900 focus-visible:outline-black"
          >
            Create Website
          </button>

          <p id="form-msg" role="status" aria-live="polite" class="text-center text-sm text-gray-600"></p>

          <p class="mt-1 text-center text-xs text-gray-500">
            We will not send you any newsletters.
          </p>
        </form>
      </section>

      <footer class="mt-14 text-center">
        <p class="text-[11px] text-gray-400">
          This is a 100% free service by <a href="https://studiovis.at" target="_blank" rel="noopener noreferrer" class="underline decoration-gray-300 hover:decoration-gray-700">webdesign studio vis</a>.
        </p>
      </footer>
    </div>
  </main>

  <script>
    // === CONFIG ===
    const OWNER_EMAIL = "start@studiovis.at"; // same inbox as vorher

    // Validation
    const isValidEmail = v => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
    const isValidTemplateUrl = v => {
      if (!v) return true; // optional
      try {
        const u = new URL(v);
        const hostOk = u.hostname.endsWith("squarespace.com");
        const pathOk = /\/templates\//.test(u.pathname);
        return hostOk && pathOk;
      } catch { return false; }
    };

    const form = document.getElementById("request-form");
    const msg  = document.getElementById("form-msg");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      msg.textContent = "";
      msg.className = "text-center text-sm text-gray-600";

      const email = document.getElementById("email").value.trim();
      const templateUrl = document.getElementById("templateUrl").value.trim();
      const spamTrap = document.getElementById("company").value.trim();

      if (spamTrap) return;
      if (!email || !isValidEmail(email)) { msg.textContent = "Enter a valid email address."; return; }
      if (!isValidTemplateUrl(templateUrl)) { msg.textContent = "Enter a valid Squarespace template link (or leave it empty)."; return; }

      const submitBtn = form.querySelector('button[type="submit"]');
      const prevLabel = submitBtn.textContent;
      submitBtn.disabled = true;
      submitBtn.textContent = "Sending…";

      try {
        const payload = {
          Email: email,
          TemplateURL: templateUrl || "(blank)",
          Choice: templateUrl ? "Template link" : "Blank Template",
          _subject: `New Squarespace request`,
          _template: "table",
          _captcha: "false"
        };

        const res = await fetch(`https://formsubmit.co/ajax/${OWNER_EMAIL}`, {
          method: "POST",
          headers: { "Content-Type": "application/json", "Accept": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await res.json().catch(() => ({}));

        if (res.ok) {
          msg.innerHTML = "✔ Request sent. <strong>The Squarespace invite will arrive within 5 minutes.</strong>";
          msg.className = "mt-4 rounded-xl bg-emerald-50 border border-emerald-200 text-emerald-900 px-4 py-3 text-base font-medium text-center";
          form.reset();
        } else {
          msg.textContent = data.message || "There was a problem sending your request. Please try again.";
        }
      } catch {
        msg.textContent = "Network error. Please try again.";
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = prevLabel;
      }
    });
  </script>
</body>
</html>
